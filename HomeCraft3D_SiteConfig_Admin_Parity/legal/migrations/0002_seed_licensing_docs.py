# Generated by Django 5.1.15 on 2026-02-10
from __future__ import annotations

from django.db import migrations


def seed_docs(apps, schema_editor):
    LegalDocument = apps.get_model("legal", "LegalDocument")

    docs = [
        ("terms", 1, "Terms of Service", "<h2>1. Overview</h2>\n<p>Home Craft 3D (\u201cHome Craft 3D\u201d, \u201cwe\u201d, \u201cus\u201d) operates an online marketplace that allows:</p>\n<ul>\n  <li><strong>Physical products</strong> (3D prints) sold and shipped by independent sellers; and</li>\n  <li><strong>Digital products</strong> (downloadable 3D model files) sold or offered for free by independent sellers.</li>\n</ul>\n<p>By accessing or using the site, creating an account, listing items, purchasing, or downloading, you agree to these Terms.</p>\n\n<h2>2. Marketplace Roles</h2>\n<ul>\n  <li><strong>Buyers</strong> browse, purchase, and download products.</li>\n  <li><strong>Sellers</strong> list products and fulfill orders for physical goods.</li>\n  <li><strong>Home Craft 3D</strong> provides the platform and may collect marketplace fees.</li>\n</ul>\n\n<h2>3. Accounts and Eligibility</h2>\n<p>You must provide accurate information, keep your credentials secure, and comply with applicable laws. Usernames are public and shown across the marketplace.</p>\n\n<h2>4. Orders, Payments, and Fees</h2>\n<p>Checkout is processed through Stripe. Marketplace fees (e.g., a percentage of sales) may apply and are disclosed in seller-facing areas. Fees are snapshotted at the time of order for accounting accuracy.</p>\n\n<h2>5. Digital Products</h2>\n<p>Digital products may be paid or free. Downloads are provided after successful payment for paid items. Free items may be downloaded immediately when available under platform rules.</p>\n<p>Digital items are licensed, not sold. The <a href=\"/legal/digital-license/\">Digital Product License</a> governs permitted use.</p>\n\n<h2>6. Physical Products</h2>\n<p>Physical products are fulfilled by sellers. Shipping timelines, packaging, and delivery are seller responsibilities. See the <a href=\"/legal/physical-policy/\">Physical Product Policy</a>.</p>\n\n<h2>7. Refunds</h2>\n<p>Refund eligibility varies by product type. Digital products are generally non-refundable. Physical products may be refunded in accordance with the <a href=\"/legal/refund/\">Refund Policy</a> and seller decisioning where allowed.</p>\n\n<h2>8. User Content, Reviews, and Q&amp;A</h2>\n<p>Users may post reviews and product Q&amp;A where permitted. Content must comply with the <a href=\"/legal/content/\">Content &amp; Safety Policy</a>. We may remove content or suspend accounts consistent with policy and law.</p>\n\n<h2>9. Prohibited Conduct</h2>\n<p>You agree not to misuse the platform, attempt unauthorized access, scrape in a harmful manner, distribute malware, or infringe intellectual property rights.</p>\n\n<h2>10. Disclaimers</h2>\n<p>The platform is provided \u201cas is\u201d. We do not guarantee uninterrupted service. Sellers are independent parties; we do not manufacture third-party goods. 3D printing involves safety risks\u2014use appropriate precautions.</p>\n\n<h2>11. Limitation of Liability</h2>\n<p>To the maximum extent permitted by law, Home Craft 3D is not liable for indirect, incidental, or consequential damages, and total liability is limited to amounts paid to the marketplace related to the claim period.</p>\n\n<h2>12. Changes</h2>\n<p>We may update these Terms. New versions are published on the legal pages with versioning. Continued use after publication constitutes acceptance of the updated Terms.</p>\n\n<h2>13. Contact</h2>\n<p>For support, contact the email listed on the site footer.</p>"),
        ("privacy", 1, "Privacy Policy", "<h2>1. What We Collect</h2>\n<ul>\n  <li><strong>Account data</strong>: username, email, password hash, profile information you provide.</li>\n  <li><strong>Transaction data</strong>: orders, payments status, refunds, and payout metadata.</li>\n  <li><strong>Usage data</strong>: page views, clicks, downloads counts, and similar analytics signals.</li>\n  <li><strong>Device data</strong>: IP address and user-agent for security, fraud prevention, and audit logging.</li>\n</ul>\n\n<h2>2. How We Use Data</h2>\n<ul>\n  <li>Provide and operate the marketplace, including orders, downloads, and seller tooling.</li>\n  <li>Prevent fraud, abuse, and unauthorized access.</li>\n  <li>Send transactional communications and in-app notifications.</li>\n  <li>Improve performance and user experience.</li>\n</ul>\n\n<h2>3. Payments</h2>\n<p>Payments are processed by Stripe. We do not store full card numbers. Stripe may process data under its own policies.</p>\n\n<h2>4. Cookies and Similar Technologies</h2>\n<p>We use cookies for session management, security, and preference storage (e.g., \u201cdon\u2019t show again\u201d for sensitive-content warnings where applicable).</p>\n\n<h2>5. Sharing</h2>\n<p>We share data with service providers only as needed to operate the service (e.g., payments, email). We may disclose information to comply with law or protect rights and safety.</p>\n\n<h2>6. Your Choices</h2>\n<p>You can update certain profile fields, and you may request account deletion subject to legal and accounting retention requirements.</p>\n\n<h2>7. Security</h2>\n<p>We use reasonable technical and organizational safeguards. No system is perfectly secure; you are responsible for protecting your account credentials.</p>\n\n<h2>8. Changes</h2>\n<p>We may update this policy and publish a new version.</p>"),
        ("refund", 1, "Refund Policy", "<h2>1. General</h2>\n<p>This Refund Policy applies to purchases made on Home Craft 3D. Sellers are independent parties; refunds may require seller review.</p>\n\n<h2>2. Digital Products</h2>\n<p><strong>Digital products are non-refundable</strong> once access is provided, except where required by law.</p>\n\n<h2>3. Physical Products</h2>\n<p>Refunds may be requested for physical products. In v1, refund requests require a reason selected from a dropdown and may include optional details. Sellers may approve or decline within policy bounds.</p>\n\n<h2>4. How Refunds Work</h2>\n<ul>\n  <li>Refund requests are recorded in the platform and routed to the seller.</li>\n  <li>If approved, the seller triggers the Stripe refund from the seller UI.</li>\n  <li>Refunds may be issued per line item for physical goods.</li>\n</ul>\n\n<h2>5. Timing</h2>\n<p>Refund processing times vary by payment method and Stripe processing.</p>\n\n<h2>6. Abuse</h2>\n<p>We may restrict refund access or accounts if we detect abuse or fraud.</p>"),
        ("content", 1, "Content & Safety Policy", "<h2>1. Acceptable Use</h2>\n<p>Content on Home Craft 3D (listings, images, files, reviews, and Q&amp;A) must be lawful and respectful.</p>\n\n<h2>2. Prohibited Content</h2>\n<ul>\n  <li>Illegal goods or instructions that facilitate wrongdoing.</li>\n  <li>Hate, harassment, or threats.</li>\n  <li>Copyright infringement or unauthorized distribution.</li>\n  <li>Malware or deceptive links.</li>\n</ul>\n\n<h2>3. Sensitive Content</h2>\n<p>Sellers may tag listings as sensitive. The platform may display a warning gate with \u201cContinue\u201d / \u201cGo back\u201d and a \u201cDon\u2019t show again\u201d preference.</p>\n\n<h2>4. Moderation</h2>\n<p>Users can report content. Staff may remove content, ban, or suspend accounts. For product Q&amp;A, messages are soft-deleted and may be removed by staff after the author\u2019s deletion window expires.</p>"),
        ("digital_license", 1, "Digital Product License", "<h2>1. License Grant</h2>\n<p>When you download a digital product from Home Craft 3D, you receive a <strong>personal, non-exclusive, non-transferable</strong> license to use the files for <strong>personal 3D printing</strong> and personal display.</p>\n\n<h2>2. Permitted Uses</h2>\n<ul>\n  <li>Download and store the files for your personal use.</li>\n  <li>Slice, scale, and make reasonable modifications for personal printing (unless the seller states otherwise in the listing).</li>\n  <li>Print physical objects for yourself or as gifts (not for sale).</li>\n</ul>\n\n<h2>3. Prohibited Uses</h2>\n<ul>\n  <li>No redistribution, re-uploading, or sharing of the digital files (free or paid) to any third party.</li>\n  <li>No resale, sublicensing, or commercial exploitation of the files or derived meshes.</li>\n  <li>No posting the files to file-sharing sites, marketplaces, torrents, or \u201cfree\u201d libraries.</li>\n</ul>\n\n<h2>4. Commercial Licenses</h2>\n<p>If a seller offers a commercial license, it must be explicitly stated in the listing. In the absence of an explicit commercial grant, the default is personal-use only.</p>\n\n<h2>5. Enforcement</h2>\n<p>Violations may result in account suspension and removal of access, and may be reported to the rights holder where appropriate.</p>"),
        ("seller_agreement", 1, "Seller Agreement", "<h2>1. Seller Relationship</h2>\n<p>Sellers are independent businesses. Home Craft 3D is not the seller of third-party items and does not control seller operations.</p>\n\n<h2>2. Seller Responsibilities</h2>\n<ul>\n  <li>Accurate listings (images, descriptions, compatibility, and safety notes).</li>\n  <li>Timely fulfillment of physical orders and customer communications.</li>\n  <li>Compliance with intellectual property and applicable laws.</li>\n</ul>\n\n<h2>3. Payments and Payouts</h2>\n<p>Seller payouts are processed via Stripe Connect. Sellers are responsible for maintaining an active Stripe account and ensuring tax information is accurate. Marketplace fees may apply and are disclosed in seller tooling.</p>\n\n<h2>4. Free Digital Listings Policy</h2>\n<p>Sellers may publish a limited number of active free digital listings without completing Stripe onboarding, subject to platform limits and verification requirements. Limits are configurable by the marketplace.</p>\n\n<h2>5. Enforcement</h2>\n<p>Home Craft 3D may suspend or remove listings for policy violations, fraud, or abuse, and may place holds where required for risk management.</p>"),
        ("physical_policy", 1, "Physical Product Policy", "<h2>1. Fulfillment</h2>\n<p>Physical products are printed and shipped by sellers. Sellers set shipping parameters and flat shipping fees where supported.</p>\n\n<h2>2. Packaging and Quality</h2>\n<p>Sellers should package items to prevent damage and should disclose material and print-quality expectations. Minor print artifacts are common; sellers should describe what buyers can expect.</p>\n\n<h2>3. Delivery Issues</h2>\n<p>If an item arrives damaged or does not match the listing, buyers may submit a refund request under the Refund Policy. Sellers may request evidence (photos) to evaluate damage claims.</p>\n\n<h2>4. Safety</h2>\n<p>3D printed items may have sharp edges or small parts. Buyers are responsible for safe use and supervision where appropriate.</p>"),
    ]

    for doc_type, version, title, body in docs:
        if LegalDocument.objects.filter(doc_type=doc_type).exists():
            continue
        LegalDocument.objects.create(
            doc_type=doc_type,
            version=version,
            title=title,
            body=body,
            is_published=True,
        )


def unseed_docs(apps, schema_editor):
    LegalDocument = apps.get_model("legal", "LegalDocument")
    # Only delete version 1 docs for types we seeded, if they still match our titles.
    for doc_type, title in [
        ("terms", "Terms of Service"),
        ("privacy", "Privacy Policy"),
        ("refund", "Refund Policy"),
        ("content", "Content & Safety Policy"),
        ("digital_license", "Digital Product License"),
        ("seller_agreement", "Seller Agreement"),
        ("physical_policy", "Physical Product Policy"),
    ]:
        LegalDocument.objects.filter(doc_type=doc_type, version=1, title=title).delete()


class Migration(migrations.Migration):

    dependencies = [
        ("legal", "0001_initial"),
    ]

    operations = [
        migrations.RunPython(seed_docs, unseed_docs),
    ]
